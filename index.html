
<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>D-value kalkulator for helidekk</title>
  <style>
    body { font-family: system-ui, sans-serif; margin: 2rem; }
    .wrap { max-width: 860px; margin: auto; }
    h1 { margin-top: 0; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background: #f5f7fb; }
    input[type="number"] { width: 120px; }
    .row { display: flex; gap: 1rem; align-items: center; flex-wrap: wrap; }
    .factors { margin-top: 1rem; }
    .muted { color: #555; font-size: 0.95rem; }
    .small { font-size: 0.9rem; }
    button { padding: 8px 14px; }
  </style>
</head>
<body>
  <div class="wrap">
    <h1>D-value kalkulator for helidekk</h1>
    <p class="muted">Skriv inn faktisk D (samme enhet for alle lengder, f.eks. meter). Legg til/endre faktorer i tabellen. Lengdene beregnes som <em>D × faktor</em>.</p>

    <div class="row">
      <label for="dval"><strong>Faktisk D:</strong></label>
      <input id="dval" type="number" value="22" step="0.01" />
      <button id="addRow">+ Legg til faktor</button>
      <button id="reset">Tilbakestill</button>
    </div>

    <div class="factors">
      <table id="tbl">
        <thead>
          <tr>
            <th>Beskrivelse</th>
            <th>Faktor (andel av D)</th>
            <th>Lengde</th>
          </tr>
        </thead>
        <tbody>
        </tbody>
      </table>
      <p class="small muted">Tips: Skriv 0.83 for 83% av D, 1.00 for full D, osv.</p>
    </div>
  </div>

  <script>
    // Alle originalfaktorer + nye: 62%, 12%, 6%
    const defaults = [
      { desc: 'Full D (diameter)', f: 1.00 },
      { desc: '95% av D', f: 0.95 },
      { desc: '90% av D', f: 0.90 },
      { desc: '87% av D', f: 0.87 },
      { desc: '85% av D', f: 0.85 },
      { desc: '83% av D', f: 0.83 },
      { desc: '75% av D', f: 0.75 },
      { desc: '50% av D', f: 0.50 },
      { desc: '62% av D', f: 0.62 },
      { desc: '12% av D', f: 0.12 },
      { desc: '6% av D', f: 0.06 }
    ];

    const tbody = document.querySelector('#tbl tbody');
    const dval = document.getElementById('dval');

    function addRow(desc = '', f = 0.83) {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td contenteditable="true">${desc}</td>
        <td><input type="number" step="0.01" value="${(isFinite(f) ? f : 0.83).toFixed(2)}"></td>
        <td class="len">–</td>
      `;
      tbody.appendChild(tr);
      recalc();
    }

    function recalc() {
      const D = parseFloat(dval.value) || 0;
      document.querySelectorAll('#tbl tbody tr').forEach(tr => {
        const f = parseFloat(tr.querySelector('input').value) || 0;
        const len = D * f;
        tr.querySelector('.len').textContent = isFinite(len) ? len.toFixed(2) : '–';
      });
    }

    function reset() {
      tbody.innerHTML = '';
      defaults.forEach(x => addRow(x.desc, x.f));
      recalc();
    }

    document.getElementById('addRow').addEventListener('click', () => addRow('Ny faktor', 0.10));
    document.getElementById('reset').addEventListener('click', reset);
    dval.addEventListener('input', recalc);
    tbody.addEventListener('input', recalc);

    // init
    reset();
  </script>
</body>
